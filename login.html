<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Login | Webshop</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!--===============================================================================================-->
    <link
      rel="stylesheet"
      type="text/css"
      href="vendor/bootstrap/css/bootstrap.min.css"
    />
    <!--===============================================================================================-->
    <link
      rel="stylesheet"
      type="text/css"
      href="assets/fonts/font-awesome-4.7.0/css/font-awesome.min.css"
    />
    <!--===============================================================================================-->
    <link
      rel="stylesheet"
      type="text/css"
      href="assets/fonts/Linearicons-Free-v1.0.0/icon-font.min.css"
    />
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="vendor/animate/animate.css" />
    <!--===============================================================================================-->
    <link
      rel="stylesheet"
      type="text/css"
      href="vendor/animsition/css/animsition.min.css"
    />
    <!--===============================================================================================-->
    <link
      rel="stylesheet"
      type="text/css"
      href="vendor/select2/select2.min.css"
    />
    <!--===============================================================================================-->
    <link
      rel="stylesheet"
      type="text/css"
      href="vendor/daterangepicker/daterangepicker.css"
    />
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="assets/css/util.css" />
    <link rel="stylesheet" type="text/css" href="assets/css/login.css" />
    <!--===============================================================================================-->

    <!-- Toastr CSS -->
    <link
      href="//cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css"
      rel="stylesheet"
    />
    <!-- Bootstrap Core CSS -->
    <link href="./assets/css/bootstrap.min.css" rel="stylesheet" />
  </head>
  <body style="display: none">
    <div id="form-alert" class="row hidden" style="display: block; margin: 2em">
      <div class="alert alert-success" role="alert">
        This is a success alertâ€”check it out!
      </div>
    </div>

    <div class="limiter">
      <div class="container-login100">
        <div class="wrap-login100 p-t-50 p-b-90">
          <div id="login-form-container">
            <form
              id="login-form"
              class="login100-form validate-form flex-sb flex-w"
              role="form"
            >
              <span class="login100-form-title p-b-51"> Login </span>

              <div
                class="wrap-input100 validate-input m-b-16"
                data-validate="Email is required"
              >
                <input
                  class="input100"
                  type="email"
                  name="email"
                  placeholder="Email"
                  minlength="5"
                  required
                />
                <span class="focus-input100"></span>
              </div>

              <div
                class="wrap-input100 validate-input m-b-16"
                data-validate="Password is required"
              >
                <input
                  class="input100"
                  type="password"
                  name="password"
                  placeholder="Password"
                  minlength="8"
                  required
                />
                <span class="focus-input100"></span>
              </div>

              <div class="flex-sb-m w-full p-t-3 p-b-24">
                <div>
                  <a href="#" onclick="showForgotForm()" class="txt1">
                    Forgot Password
                  </a>
                </div>
                <div>
                  <a href="#" onclick="showRegisterForm()" class="txt1">
                    Register Here
                  </a>
                </div>
              </div>
              <div class="container-login100-form-btn m-t-17">
                <button
                  id="login-link"
                  onclick="doLogin();"
                  class="login100-form-btn"
                >
                  Login
                </button>
              </div>
            </form>
          </div>
          <br /><br /><br />
          <div id="register-form-container" class="hidden">
            <form
              id="register-form"
              class="login100-form validate-form flex-sb flex-w"
              role="form"
            >
              <span class="login100-form-title p-b-51"> Register </span>

              <div class="wrap-input100 validate-input m-b-16">
                <input
                  class="input100"
                  type="text"
                  name="name"
                  placeholder="Name"
                  required
                  minlength="2"
                />
                <span class="focus-input100"></span>
              </div>

              <div class="wrap-input100 validate-input m-b-16">
                <input
                  class="input100"
                  type="text"
                  name="surname"
                  placeholder="Surname"
                  required
                  minlength="2"
                />
                <span class="focus-input100"></span>
              </div>
              <div
                class="wrap-input100 validate-input m-b-16"
                data-validate="Email Address is required"
              >
                <input
                  class="input100"
                  type="email"
                  name="email"
                  placeholder="Email Address"
                  required
                  minlength="5"
                />
                <span class="focus-input100"></span>
              </div>

              <div
                class="wrap-input100 validate-input m-b-16"
                data-validate="Password is required"
              >
                <input
                  class="input100"
                  type="password"
                  name="password"
                  placeholder="Password"
                  required
                  minlength="8"
                />
                <span class="focus-input100"></span>
              </div>
              <div
                class="wrap-input100 validate-input m-b-16"
                data-validate="Phone Number is required"
              >
                <input
                  class="input100"
                  type="text"
                  name="phone_number"
                  placeholder="Phone Number"
                  required
                  minlength="9"
                  maxlength="16"
                />
                <span class="focus-input100"></span>
              </div>

              <div
                class="wrap-input100 validate-input m-b-16"
                data-validate="City is required"
              >
                <input
                  class="input100"
                  type="text"
                  name="city"
                  placeholder="City"
                  required
                  minlength="3"
                />
                <span class="focus-input100"></span>
              </div>
              <div
                class="wrap-input100 validate-input m-b-16"
                data-validate="Zip Code is required"
              >
                <input
                  class="input100"
                  type="number"
                  name="zip_code"
                  placeholder="Zip Code"
                  required
                  maxlength="5"
                  minlength="5"
                />
                <span class="focus-input100"></span>
              </div>

              <div
                class="wrap-input100 validate-input m-b-16"
                data-validate="Address is required"
              >
                <input
                  class="input100"
                  type="text"
                  name="address"
                  placeholder="Address"
                  required
                  minlength="5"
                />
                <span class="focus-input100"></span>
              </div>

              <div class="flex-sb-m w-full p-t-3 p-b-24">
                <div></div>
                <div>
                  <a href="#" onclick="showLoginForm()" class="txt1">
                    Back to login
                  </a>
                </div>
              </div>
              <div class="container-login100-form-btn m-t-17">
                <button
                  id="register-link"
                  onclick="doRegister();"
                  class="login100-form-btn"
                >
                  Register
                </button>
              </div>
            </form>
          </div>
          <div id="forgot-form-container" class="hidden">
            <form id="forgot-form" role="form">
              <span class="login100-form-title p-b-51"> Forgot password </span>

              <div
                class="wrap-input100 validate-input m-b-16"
                data-validate="Email is required"
              >
                <input
                  class="input100"
                  type="email"
                  name="email"
                  placeholder="Email"
                  minlength="5"
                  required
                />
                <span class="focus-input100"></span>
              </div>
              <div class="flex-sb-m w-full p-t-3 p-b-24">
                <div></div>
                <div>
                  <a href="#" onclick="showLoginForm()" class="txt1">
                    Back to login
                  </a>
                </div>
              </div>
              <div class="container-login100-form-btn m-t-17">
                <button onclick="doForgotPassword()" class="login100-form-btn">
                  Send recoverey link
                </button>
              </div>
            </form>
          </div>
          <div id="change-password-form-container" class="hidden">
            <form id="change-password-form" role="form">
              <span class="login100-form-title p-b-51"> Change password </span>
              <input
                id="change-password-token"
                class="input100"
                type="hidden"
                name="token"
              />
              <span class="focus-input100"></span>
              <div
                class="wrap-input100 validate-input m-b-16"
                data-validate="Password is required"
              >
                <input
                  class="input100"
                  type="password"
                  name="password"
                  placeholder="Password"
                  minlength="8"
                  required
                />
                <span class="focus-input100"></span>
              </div>
              <div class="flex-sb-m w-full p-t-3 p-b-24">
                <div></div>
                <div>
                  <a href="#" onclick="showLoginForm()" class="txt1">
                    Back to login
                  </a>
                </div>
              </div>
              <div class="container-login100-form-btn m-t-17">
                <button
                  id="change-link"
                  onclick="doChangePassword();"
                  class="login100-form-btn"
                >
                  Change password
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!--===============================================================================================-->
    <script src="vendor/jquery/jquery-3.2.1.min.js"></script>
    <!--===============================================================================================-->
    <script src="vendor/animsition/js/animsition.min.js"></script>
    <!--===============================================================================================-->
    <script src="vendor/bootstrap/js/popper.js"></script>
    <!-- Bootstrap Core JavaScript -->
    <script src="./assets/js/bootstrap.min.js"></script>
    <!--===============================================================================================-->
    <script src="vendor/select2/select2.min.js"></script>
    <!--===============================================================================================-->
    <script src="vendor/daterangepicker/moment.min.js"></script>
    <script src="vendor/daterangepicker/daterangepicker.js"></script>
    <!--===============================================================================================-->
    <script src="//cdn.jsdelivr.net/npm/jquery-validation@1.19.3/dist/jquery.validate.min.js"></script>
    <!--===============================================================================================-->
    <script src="assets/js/login.js"></script>
    <!-- JavaScript utility functions-->
    <script src="./assets/js/utils.js"></script>
    <!-- Toastr JS -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>

    <script type="text/javascript">
      $(function () {
        if (window.localStorage.getItem("token")) {
          window.location = "index.html";
        } else {
          $("body").show();
        }
        var urlParams = new URLSearchParams(window.location.search);
        if (urlParams.has("token")) {
          $("#change-password-token").val(urlParams.get("token"));
          showChangePasswordForm();
        }
      });

      function showChangePasswordForm() {
        $("#change-password-form-container").removeClass("hidden");
        $("#login-form-container").addClass("hidden");
        $("#register-form-container").addClass("hidden");
        $("#register-form-container").addClass("hidden");
      }

      function showForgotForm() {
        $("#login-form-container").addClass("hidden");
        $("#forgot-form-container").removeClass("hidden");
      }

      function showRegisterForm() {
        $("#login-form-container").addClass("hidden");
        $("#register-form-container").removeClass("hidden");
      }

      function showLoginForm() {
        $("#login-form-container").removeClass("hidden");
        $("#register-form-container").addClass("hidden");
        $("#forgot-form-container").addClass("hidden");
      }

      function doRegister() {
        $("#register-link").prop("disabled", true);
        $.post("api/register", jsonize_form("#register-form"))
          .done(function (data) {
            console.log(data);
            $("#register-form-container").addClass("hidden");
            $("#form-alert").removeClass("hidden");
            $("#form-alert .alert").html(data.message);
          })
          .fail(function (error) {
            $("#register-link").prop("disabled", false);
            console.log(error);
            toastr.error(error.responseJSON.message);
          });
      }

      function doLogin() {
        $("#login-link").prop("disabled", true);
        $.post("api/login", jsonize_form("#login-form"))
          .done(function (data) {
            window.localStorage.setItem("token", data.token);
            window.location = "index.html";
          })
          .fail(function (error) {
            $("#login-link").prop("disabled", false);
            toastr.error(error.responseJSON.message);
          });
      }

      function doForgotPassword() {
        $("#forgot-link").prop("disabled", true);
        $.post("api/forgot", jsonize_form("#forgot-form"))
          .done(function (data) {
            console.log(data);
            $("#forgot-form-container").addClass("hidden");
            $("#form-alert").removeClass("hidden");
            $("#form-alert .alert").html(data.message);
          })
          .fail(function (error) {
            $("#forgot-link").prop("disabled", false);
            $("#forgot-form-container").addClass("hidden");
            $("#form-alert").removeClass("hidden");
            $("#form-alert .alert").html(error.responseJSON.message);
          });
      }

      function doChangePassword() {
        $("#change-link").prop("disabled", true);
        $.post("api/reset", jsonize_form("#change-password-form"))
          .done(function (data) {
            window.localStorage.setItem("token", data.token);
            window.location = "index.html";
          })
          .fail(function (error) {
            $("#change-link").prop("disabled", false);
            toastr.error(error.responseJSON.message);
          });
      }

      $("#register-form").validate({
        submitHandler: function (form) {
          form.submit();
        },
      });

      $("#login-form").validate({
        submitHandler: function (form) {
          form.submit();
        },
      });
      $("#forgot-form").validate({
        submitHandler: function (form) {
          form.submit();
        },
      });
      $("#change-password-form").validate({
        submitHandler: function (form) {
          form.submit();
        },
      });
    </script>
  </body>
</html>
